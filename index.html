<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>w-shop — pastel remix (single file)</title>
  <style>
    /* ENTIRELY NEW STYLE: pastel, warm, airy, soft-glass aesthetic */
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --muted:#7b8794;
      --accent:#ff7ab6; /* pink */
      --accent-2:#7ad0ff; /* sky */
      --glass: rgba(255,255,255,0.6);
      --shadow: 0 6px 18px rgba(22,30,50,0.07);
      --radius:14px;
      --mono: 'Segoe UI', Roboto, -apple-system, system-ui, "Helvetica Neue", Arial;
    }
    html,body{height:100%;background:linear-gradient(180deg,var(--bg),#eef3f8);font-family:var(--mono);color:#10283a;margin:0}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:40px}
    .app{
      width:100%;max-width:1100px;background:linear-gradient(180deg,rgba(255,255,255,0.9),rgba(250,251,255,0.96));border-radius:20px;box-shadow:var(--shadow);padding:28px;backdrop-filter:blur(6px);
      border:1px solid rgba(12,18,30,0.04);
    }
    header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
    .title{
      line-height:1;
    }
    h1{font-size:30px;margin:0;color:#0f2b3a}
    .subtitle{font-size:12px;color:var(--muted);margin-top:6px}

    /* user controls */
    .user-controls{display:flex;align-items:center;gap:10px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;background:linear-gradient(90deg,var(--glass),rgba(255,255,255,0.85));border:1px solid rgba(16,40,50,0.06);cursor:pointer;box-shadow:0 2px 6px rgba(16,40,50,0.04);font-weight:600}
    .btn.small{padding:6px 8px;border-radius:10px;font-size:13px}
    .badge{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:6px 8px;border-radius:999px;font-size:12px}
    .user-name{font-size:14px;color:#16323b}

    /* tabs */
    .tabs{display:flex;gap:10px;margin-top:20px}
    .tab{padding:10px 16px;border-radius:12px;background:transparent;color:var(--muted);cursor:pointer;border:1px solid transparent}
    .tab.active{background:linear-gradient(90deg,rgba(122,208,255,0.18),rgba(255,122,182,0.08));box-shadow:0 6px 18px rgba(122,208,255,0.06);color:#0f2b3a}

    /* layout */
    .content{display:grid;grid-template-columns:300px 1fr;gap:18px;margin-top:18px}
    .card{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow);border:1px solid rgba(10,20,30,0.03)}
    .side{display:flex;flex-direction:column;gap:12px}
    .categories{display:flex;flex-wrap:wrap;gap:8px}
    .cat-btn{padding:8px 10px;border-radius:999px;border:1px dashed rgba(16,40,50,0.06);background:transparent;cursor:pointer;font-size:13px}
    .cat-btn.active{background:linear-gradient(90deg,rgba(255,122,182,0.12),rgba(122,208,255,0.08));border-style:solid}

    /* product list */
    .products-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .product-card{padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff, #fbfcff);border:1px solid rgba(10,20,30,0.03)}
    .p-title{font-weight:700;margin:0 0 6px 0}
    .p-desc{font-size:13px;color:var(--muted);margin:0 0 8px 0}
    .p-meta{font-size:12px;color:var(--muted);display:flex;justify-content:space-between}
    .p-actions{display:flex;gap:8px;margin-top:10px}
    .pill{padding:6px 8px;border-radius:10px;font-size:13px;border:1px solid rgba(10,20,30,0.04);background:transparent;cursor:pointer}

    /* forms */
    label{display:block;font-size:13px;color:#234044;margin-bottom:6px}
    input[type=text], input[type=url], textarea, input[type=number], input[type=file]{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(16,40,50,0.06);background:linear-gradient(180deg,#fff,#fbfdff);box-sizing:border-box}
    textarea{min-height:80px;resize:vertical}
    .muted{color:var(--muted);font-size:13px}
    .row{display:flex;gap:8px}
    .flex{flex:1}

    /* reviews */
    .review-card{padding:10px;border-radius:10px;border:1px solid rgba(16,40,50,0.04);background:linear-gradient(180deg,#fff,#fbfcff)}
    .reviewer{font-weight:700}
    .r-date{font-size:12px;color:var(--muted)}

    /* contact cards side-by-side on contact tab */
    .contact-grid{display:grid;grid-template-columns:1fr 320px;gap:12px}

    /* responsive */
    @media(max-width:880px){
      .content{grid-template-columns:1fr;}
      .contact-grid{grid-template-columns:1fr}
      .tabs{overflow:auto}
    }
    footer{margin-top:14px;font-size:12px;color:var(--muted);text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app" id="app">
      <header>
        <div class="title">
          <h1>w-shop</h1>
          <div class="subtitle">stock sales and reviews — pastel remix</div>
        </div>
        <div class="user-controls">
          <div class="user-name" id="displayName">guest</div>
          <div id="adminBadge" style="display:none" class="badge">ADMIN</div>
          <button class="btn small" id="loginBtn">Log in</button>
          <button class="btn small" id="logoutBtn" style="display:none">Log out</button>
        </div>
      </header>

      <nav class="tabs" role="tablist">
        <button class="tab active" data-tab="sales">Sales</button>
        <button class="tab" data-tab="reviews">Reviews</button>
        <button class="tab" data-tab="contact">Contact</button>
      </nav>

      <main style="margin-top:16px">
        <!-- SALES TAB -->
        <section class="content" id="salesTab">
          <aside class="side card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <strong>Categories</strong>
              <button id="newCatBtn" class="btn small" title="New category">New</button>
            </div>
            <div class="muted" style="font-size:12px;margin-top:6px">Select a category to view and add products</div>
            <div class="categories" id="categoriesList" style="margin-top:12px"></div>
          </aside>

          <section class="card">
            <div class="products-header">
              <div>
                <div id="selectedCatName" style="font-weight:800">No category selected</div>
                <div class="muted" id="selectedCatInfo">Choose a category from the left or create a new one.</div>
              </div>
            </div>

            <div id="adminProductForm" style="display:none;margin-bottom:12px">
              <form id="addProductForm" onsubmit="return false">
                <div style="display:grid;grid-template-columns:1fr 120px;gap:8px">
                  <div>
                    <label>Product name</label>
                    <input type="text" id="pname" required placeholder="e.g. Comfortable mug" />
                  </div>
                  <div>
                    <label>Cost</label>
                    <input type="number" id="pcost" required min="0" step="0.01" placeholder="12.50" />
                  </div>
                </div>
                <label style="margin-top:8px">Description</label>
                <textarea id="pdesc" placeholder="Short description"></textarea>
                <label style="margin-top:8px">Link (offer URL)</label>
                <input type="url" id="plink" placeholder="https://example.com/product" />
                <div style="display:flex;gap:8px;margin-top:10px">
                  <button id="addProductBtn" class="btn">Add product</button>
                  <button id="clearProductForm" class="btn" type="button">Clear</button>
                </div>
              </form>
            </div>

            <div id="productsGrid" class="grid"></div>
          </section>
        </section>

        <!-- REVIEWS TAB (hidden by default) -->
        <section id="reviewsTab" style="display:none;margin-top:10px">
          <div class="content">
            <aside class="side card">
              <div><strong>Leave a review</strong></div>
              <form id="reviewForm" onsubmit="return false">
                <label>Name</label>
                <input type="text" id="rname" placeholder="Your name" required />
                <label style="margin-top:8px">Review</label>
                <textarea id="rtext" placeholder="Your thoughts..." required></textarea>
                <div style="display:flex;gap:8px;margin-top:10px">
                  <button id="addReviewBtn" class="btn">Add review</button>
                  <button id="clearReviewsBtn" class="btn" type="button">Clear all</button>
                </div>
              </form>
            </aside>

            <section class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                <strong>Reviews</strong>
                <div class="muted">Stored locally in your browser</div>
              </div>
              <div id="reviewsList" style="display:flex;flex-direction:column;gap:8px"></div>
            </section>
          </div>

          <div style="margin-top:12px;display:flex;gap:12px;flex-direction:column">
            <div class="card">
              <strong>Backup / Import</strong>
              <div style="margin-top:8px" class="muted">Export or import app data (categories, products, reviews, session).</div>
              <div style="display:flex;gap:8px;margin-top:10px">
                <button id="exportBtn" class="btn">Export JSON</button>
                <label class="btn" for="importFile">Import JSON</label>
                <input id="importFile" type="file" accept="application/json" style="display:none" />
                <button id="resetBtn" class="btn">Reset (clear all)</button>
              </div>
            </div>
          </div>
        </section>

        <!-- CONTACT TAB -->
        <section id="contactTab" style="display:none;margin-top:10px">
          <div class="contact-grid">
            <div class="card">
              <strong>Contact owner</strong>
              <div class="muted" style="margin-top:6px">Message will open your email client (mailto) or you can copy the message to clipboard.</div>
              <form id="contactForm" onsubmit="return false" style="margin-top:8px">
                <label>Name</label>
                <input type="text" id="cname" placeholder="Your name" required />
                <label style="margin-top:8px">Email (optional)</label>
                <input type="text" id="cemail" placeholder="you@example.com" />
                <label style="margin-top:8px">Message</label>
                <textarea id="cmessage" placeholder="Hi — I'd like to..." required></textarea>
                <div style="display:flex;gap:8px;margin-top:8px">
                  <button id="mailtoBtn" class="btn">Open email</button>
                  <button id="copyMessageBtn" class="btn" type="button">Copy message</button>
                </div>
              </form>
            </div>

            <div class="card">
              <strong>Owner info</strong>
              <div class="muted" style="margin-top:8px">Admin username:</div>
              <div id="ownerName" style="font-weight:800;margin-top:6px"></div>
              <div class="muted" style="margin-top:10px">Note: To become admin, log in with the admin username (no password required).</div>
            </div>
          </div>
        </section>

      </main>

      <footer>Built for local usage • Data stored in localStorage • Paste on GitHub as a single HTML file</footer>
    </div>
  </div>

  <script>
    (function(){
      // --- CONFIG ---
      const ADMIN_USERNAME = 'owner'; // changeable — shown in contact
      const STORAGE_KEY = 'wshop_remix_data_v1';
      const SESSION_KEY = 'wshop_remix_session_v1';

      // --- DEFAULT DATA ---
      const defaultData = { categories: [], reviews: [] };

      // --- UTIL ---
      const $ = (sel, ctx=document)=>ctx.querySelector(sel);
      const $$ = (sel, ctx=document)=>Array.from(ctx.querySelectorAll(sel));
      const nowISO = ()=>new Date().toISOString();
      const formatDate = iso => new Date(iso).toLocaleString();

      function loadData(){
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          return raw ? JSON.parse(raw) : JSON.parse(JSON.stringify(defaultData));
        }catch(e){
          console.error('Failed load',e);return JSON.parse(JSON.stringify(defaultData));
        }
      }
      function saveData(d){ localStorage.setItem(STORAGE_KEY,JSON.stringify(d)); }
      function loadSession(){ try{ const raw=localStorage.getItem(SESSION_KEY); return raw?JSON.parse(raw):{user:null}; }catch(e){return {user:null};} }
      function saveSession(s){ localStorage.setItem(SESSION_KEY,JSON.stringify(s)); }

      // --- STATE ---
      let data = loadData();
      let session = loadSession();
      let selectedCategory = null;

      // --- ELEMENTS ---
      const tabs = $$('.tab');
      const salesTab = $('#salesTab');
      const reviewsTab = $('#reviewsTab');
      const contactTab = $('#contactTab');

      const displayNameEl = $('#displayName');
      const adminBadge = $('#adminBadge');
      const loginBtn = $('#loginBtn');
      const logoutBtn = $('#logoutBtn');

      const newCatBtn = $('#newCatBtn');
      const categoriesList = $('#categoriesList');
      const selectedCatName = $('#selectedCatName');
      const selectedCatInfo = $('#selectedCatInfo');
      const adminProductForm = $('#adminProductForm');
      const addProductForm = $('#addProductForm');
      const addProductBtn = $('#addProductBtn');
      const clearProductForm = $('#clearProductForm');
      const productsGrid = $('#productsGrid');

      // reviews
      const reviewForm = $('#reviewForm');
      const rname = $('#rname');
      const rtext = $('#rtext');
      const reviewsList = $('#reviewsList');
      const addReviewBtn = $('#addReviewBtn');
      const clearReviewsBtn = $('#clearReviewsBtn');

      // backup
      const exportBtn = $('#exportBtn');
      const importFile = $('#importFile');
      const resetBtn = $('#resetBtn');

      // contact
      const ownerName = $('#ownerName');
      const mailtoBtn = $('#mailtoBtn');
      const copyMessageBtn = $('#copyMessageBtn');
      const cname = $('#cname');
      const cemail = $('#cemail');
      const cmessage = $('#cmessage');

      // init
      function init(){
        ownerName.textContent = ADMIN_USERNAME;
        renderSession();
        renderCategories();
        renderProducts();
        renderReviews();
        attach();
      }

      // --- session handling ---
      function renderSession(){
        const user = session.user;
        displayNameEl.textContent = user || 'guest';
        const isAdmin = user === ADMIN_USERNAME;
        adminBadge.style.display = isAdmin ? 'inline-block' : 'none';
        loginBtn.style.display = user ? 'none' : 'inline-flex';
        logoutBtn.style.display = user ? 'inline-flex' : 'none';
        adminProductForm.style.display = isAdmin && selectedCategory ? '' : 'none';
      }
      loginBtn.addEventListener('click',()=>{
        const u = prompt('Enter username to log in:');
        if(!u) return;
        session.user = u.trim(); saveSession(session); renderSession();
      });
      logoutBtn.addEventListener('click',()=>{ session.user = null; saveSession(session); renderSession(); });

      // --- tabs ---
      tabs.forEach(t=>t.addEventListener('click',()=>{
        tabs.forEach(x=>x.classList.remove('active'));
        t.classList.add('active');
        const tab = t.dataset.tab;
        salesTab.style.display = tab==='sales' ? '' : 'none';
        reviewsTab.style.display = tab==='reviews' ? '' : 'none';
        contactTab.style.display = tab==='contact' ? '' : 'none';
      }));

      // --- categories ---
      function createCategory(name){ if(!name) return; data.categories.push({id: 'c_' + Date.now(), name, products:[]}); saveData(data); renderCategories(); }
      newCatBtn.addEventListener('click',()=>{
        if(session.user !== ADMIN_USERNAME){ alert('Only admin can create categories'); return; }
        const name = prompt('New category name:'); if(!name) return; createCategory(name.trim());
      });

      function renderCategories(){
        categoriesList.innerHTML = '';
        if(data.categories.length===0){ categoriesList.innerHTML = '<div class="muted">No categories yet</div>'; selectedCategory=null; selectedCatName.textContent='No category selected'; selectedCatInfo.textContent='Create one using the New button (admin only).'; renderProducts(); return; }
        data.categories.forEach(cat=>{
          const b = document.createElement('button'); b.className='cat-btn'; b.textContent=cat.name; b.addEventListener('click',()=>{ selectCategory(cat.id); });
          if(selectedCategory===cat.id) b.classList.add('active');
          categoriesList.appendChild(b);
        });
      }

      function selectCategory(id){ selectedCategory=id; const cat = data.categories.find(c=>c.id===id); selectedCatName.textContent = cat ? cat.name : '—'; selectedCatInfo.textContent = cat ? (cat.products.length + ' product(s)') : '';
        renderCategories(); renderProducts(); const isAdmin = session.user===ADMIN_USERNAME; adminProductForm.style.display = isAdmin ? '' : 'none'; }

      // --- products ---
      addProductBtn.addEventListener('click',()=>{
        if(session.user !== ADMIN_USERNAME){ alert('Only admin can add products'); return; }
        const cat = data.categories.find(c=>c.id===selectedCategory);
        if(!cat){ alert('Select a category first'); return; }
        const name = $('#pname').value.trim(); const desc = $('#pdesc').value.trim(); const cost = parseFloat($('#pcost').value) || 0; const link = $('#plink').value.trim();
        if(!name) { alert('Product needs a name'); return; }
        const product = { id: 'p_'+Date.now(), name, desc, cost, link, added: nowISO() };
        cat.products.unshift(product); saveData(data); renderProducts(); addProductForm.reset();
      });
      clearProductForm.addEventListener('click',()=>addProductForm.reset());

      function renderProducts(){ productsGrid.innerHTML = '';
        const cat = data.categories.find(c=>c.id===selectedCategory);
        if(!cat){ productsGrid.innerHTML = '<div class="muted">No category selected</div>'; return; }
        if(cat.products.length===0){ productsGrid.innerHTML = '<div class="muted">No products yet — add one using the form above (admin)</div>'; return; }
        cat.products.forEach(prod=>{
          const pc = document.createElement('div'); pc.className='product-card';
          pc.innerHTML = `<div class="p-title">${escapeHtml(prod.name)}</div>
                          <div class="p-desc">${escapeHtml(prod.desc || '')}</div>
                          <div class="p-meta"><div>Cost: $${Number(prod.cost).toFixed(2)}</div><div class="muted">${formatDate(prod.added)}</div></div>`;
          const actions = document.createElement('div'); actions.className='p-actions';
          const openBtn = document.createElement('button'); openBtn.className='pill'; openBtn.textContent='Open offer'; openBtn.addEventListener('click',()=>{ if(prod.link) window.open(prod.link,'_blank'); else alert('No link provided'); });
          const copyBtn = document.createElement('button'); copyBtn.className='pill'; copyBtn.textContent='Copy link'; copyBtn.addEventListener('click',()=>{ const txt = prod.link || location.href; navigator.clipboard.writeText(txt).then(()=>{ alert('Link copied to clipboard'); }).catch(()=>{ alert('Copy failed — your browser may block clipboard access'); }); });
          actions.appendChild(openBtn); actions.appendChild(copyBtn);
          if(session.user === ADMIN_USERNAME){ const del = document.createElement('button'); del.className='pill'; del.textContent='Delete'; del.addEventListener('click',()=>{ if(confirm('Delete this product?')){ cat.products = cat.products.filter(p=>p.id!==prod.id); saveData(data); renderProducts(); } }); actions.appendChild(del); }
          pc.appendChild(actions);
          productsGrid.appendChild(pc);
        });
      }

      // --- reviews ---
      addReviewBtn.addEventListener('click',()=>{
        const name = rname.value.trim(); const text = rtext.value.trim(); if(!name||!text) return alert('Fill name and review');
        data.reviews.unshift({id:'r_'+Date.now(), name, text, date: nowISO()}); saveData(data); renderReviews(); reviewForm.reset();
      });
      clearReviewsBtn.addEventListener('click',()=>{ if(!confirm('Clear all reviews?')) return; data.reviews=[]; saveData(data); renderReviews(); });

      function renderReviews(){ reviewsList.innerHTML=''; if(!data.reviews||data.reviews.length===0){ reviewsList.innerHTML='<div class="muted">No reviews yet</div>'; return; }
        data.reviews.forEach(r=>{
          const div = document.createElement('div'); div.className='review-card'; div.innerHTML = `<div class="reviewer">${escapeHtml(r.name)}</div><div class="r-date">${formatDate(r.date)}</div><div style="margin-top:6px">${escapeHtml(r.text)}</div>`; reviewsList.appendChild(div);
        });
      }

      // --- backup / import / reset ---
      exportBtn.addEventListener('click',()=>{
        const content = {data, session}; const blob = new Blob([JSON.stringify(content,null,2)],{type:'application/json'});
        const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='wshop-backup.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      });
      importFile.addEventListener('change', async (e)=>{
        const f = e.target.files[0]; if(!f) return; try{ const text = await f.text(); const parsed = JSON.parse(text); if(parsed.data) { data = parsed.data; session = parsed.session||{user:null}; saveData(data); saveSession(session); selectedCategory = null; renderCategories(); renderProducts(); renderReviews(); renderSession(); alert('Import successful'); } else { alert('Invalid backup format'); } }catch(err){ alert('Import failed: '+err); }
        importFile.value='';
      });
      resetBtn.addEventListener('click',()=>{ if(!confirm('Clear all local data? This cannot be undone.')) return; data={categories:[],reviews:[]}; session={user:null}; saveData(data); saveSession(session); selectedCategory=null; renderCategories(); renderProducts(); renderReviews(); renderSession(); });

      // --- contact ---
      mailtoBtn.addEventListener('click',()=>{
        const to = ''; // owner email not provided — leave blank so mail client lets user set
        const subject = encodeURIComponent('Message to w-shop owner');
        const body = encodeURIComponent('From: '+cname.value+'\nEmail: '+cemail.value+'\n\n'+cmessage.value);
        const href = `mailto:${to}?subject=${subject}&body=${body}`;
        window.location.href = href;
      });
      copyMessageBtn.addEventListener('click',()=>{
        const text = `From: ${cname.value}\nEmail: ${cemail.value}\n\n${cmessage.value}`;
        navigator.clipboard.writeText(text).then(()=>alert('Message copied')).catch(()=>alert('Copy failed'));
      });

      // --- helpers ---
      function escapeHtml(str){ if(!str) return ''; return str.replace(/[&<>\"]/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[c])); }

      function attach(){
        // keyboard shortcut: ctrl+shift+a to toggle admin login prompt (convenience)
        document.addEventListener('keydown',e=>{ if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='a'){ loginBtn.click(); } });
      }

      // expose data to window for debugging when running locally
      window.__wshop = {getData:()=>JSON.parse(JSON.stringify(data)), save:()=>saveData(data)};

      init();
    })();
  </script>
</body>
</html>
